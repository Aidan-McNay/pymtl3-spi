//-------------------------------------------------------------------------
// SPILoopback__pack_size_128.v
//-------------------------------------------------------------------------
// This file is generated by PyMTL SystemVerilog translation pass.

// PyMTL VerilogPlaceholder SPILoopback Definition
// At /home/km633/Research/SPI_pymtl/sim/SPI_pymtl2/MinionModules/SPILoopback/SPILoopback.py

//***********************************************************
// Pickled source file of placeholder SPILoopback__pack_size_128
//***********************************************************

//-----------------------------------------------------------
// Dependency of placeholder SPILoopback
//-----------------------------------------------------------

`ifndef SPILOOPBACK
`define SPILOOPBACK

// The source code below are included because they are specified
// as the v_libs Verilog placeholder option of component SPILoopback__pack_size_128.

// If you get a duplicated def error from files included below, please
// make sure they are included either through the v_libs option or the
// explicit `include statement in the Verilog source code -- if they
// appear in both then they will be included twice!


// End of all v_libs files for component SPILoopback__pack_size_128

`line 1 "SPI_pymtl2/MinionModules/SPILoopback/SPILoopback.v" 0
//===========================================
// SPI Loopback
//===========================================

`ifndef LOOPBACK_V
`define LOOPBACK_V

module SPI_pymtl2_MinionModules_SPILoopback_SPILoopback
#(
  parameter pack_size = 32
)(  

  //control inputs
  input                     clk,
  input                     serve,
  input                     loop_en,

  //IO with respect to master
  input  [pack_size-1:0]    from_master,
  output [pack_size-1:0]    to_master,
  
  //IO with respect to device
  input  [pack_size-1 : 0]  from_device,
  output [pack_size-1 : 0]  to_device
); 
  
  logic [pack_size-1:0] output_mux_out;
  
  vc_Mux2 #(pack_size) output_mux
  (
    .sel (loop_en),
    .in0 (from_device),
    .in1 (from_master),
    .out (output_mux_out)
  );    
  
  assign to_master = output_mux_out;
  
  // message pass through
  assign to_device = from_master;

endmodule


//////////////////////////////////////////////////////////////////////////
// includes 
//////////////////////////////////////////////////////////////////////////

module vc_Reg
#(
  parameter p_nbits = 1
)(
  input  logic               clk, // Clock input
  output logic [p_nbits-1:0] q,   // Data output
  input  logic [p_nbits-1:0] d    // Data input
);

  always@( posedge clk )
    q <= d;

endmodule

module SignalSync
(
  input  logic                clk,
  input  logic                sig_in,
  
  output logic                sig_synced,
  output logic                sig_posedge,
  output logic                sig_negedge  
);
  
  logic [2:0] q;

  always@( posedge clk ) q <= {q[1:0], sig_in};
  
  assign sig_synced  = q[1];
  assign sig_posedge = (q[2:1] == 2'b01);
  assign sig_negedge = (q[2:1] == 2'b10);

endmodule

//------------------------------------------------------------------------
// 2 input mux
//------------------------------------------------------------------------

module vc_Mux2
#(
  parameter p_nbits = 1
)(
  input  logic [p_nbits-1:0] in0, in1,
  input  logic               sel,
  output logic [p_nbits-1:0] out
);

  always @(*)
  begin
    case ( sel )
      1'd0 : out = in0;
      1'd1 : out = in1;
      default : out = {p_nbits{1'bx}};
    endcase
  end

endmodule
`endif /* LOOPBACK_V */

`endif /* SPILOOPBACK */
//-----------------------------------------------------------
// Wrapper of placeholder SPILoopback__pack_size_128
//-----------------------------------------------------------

`ifndef SPILOOPBACK__PACK_SIZE_128
`define SPILOOPBACK__PACK_SIZE_128

module SPILoopback__pack_size_128
(
  input logic reset,
  input logic [1-1:0] clk ,
  input logic [128-1:0] from_device ,
  input logic [128-1:0] from_master ,
  input logic [1-1:0] loop_en ,
  input logic [1-1:0] serve ,
  output logic [128-1:0] to_device ,
  output logic [128-1:0] to_master 
);
  SPI_pymtl2_MinionModules_SPILoopback_SPILoopback
  #(
    .pack_size( 128 )
  ) v
  (
    .clk( clk ),
    .from_device( from_device ),
    .from_master( from_master ),
    .loop_en( loop_en ),
    .serve( serve ),
    .to_device( to_device ),
    .to_master( to_master )
  );
endmodule

`endif /* SPILOOPBACK__PACK_SIZE_128 */

